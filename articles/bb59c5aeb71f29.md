---
title: "Goã§ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ™‚ã«å®‰å…¨ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹TIPS"
emoji: "ğŸ´"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---



```go
func ValidateUploadImage(file multipart.File) error {
	buf := make([]byte, 512)
	n, err := file.Read(buf)
	if err != nil {
		return err
	}
	// ãƒ•ã‚¡ã‚¤ãƒ«ãƒã‚¤ãƒ³ã‚¿ã‚’å…ˆé ­ã«æˆ»ã™ï¼ˆå¾Œã§å†åº¦å…¨ä½“ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ï¼‰
	_, _ = file.Seek(0, io.SeekStart)

	// MIMEã‚¿ã‚¤ãƒ—ã‚’åˆ¤å®š
	detectedType := http.DetectContentType(buf[:n])

	allowedTypes := map[string]bool{
		"image/jpeg": true,
		"image/png":  true,
	}

	if !allowedTypes[detectedType] {
		return errors.NewInvalidRequestError("invalid file type")
	}
	return nil
}

```